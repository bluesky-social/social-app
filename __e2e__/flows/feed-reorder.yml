appId: xyz.blueskyweb.app
---
- runScript:
    file: ../setupServer.js
    env:
        SERVER_PATH: ?users&follows&posts&feeds
- runFlow:
    file: ../setupApp.yml
- tapOn:
    id: "e2eSignInAlice"

# Pin alice's feed
- extendedWaitUntil:
    visible:
        id: "viewHeaderDrawerBtn"
- tapOn:
    id: "viewHeaderDrawerBtn"
- tapOn:
    id: "profileCardButton"
- tapOn:
    id: "profilePager-selector-4"
- tapOn: "alice-favs"
- tapOn: "Pin to Home"
- tapOn:
    id: "bottomBarHomeBtn"
- assertNotVisible: "Feeds âœ¨"
- assertVisible:
    id: "homeScreenFeedTabs-selector-0"
    text: "Following"
- assertVisible:
    id: "homeScreenFeedTabs-selector-1"
    text: "alice-favs"

# Set alice-favs first
- tapOn:
    id: "viewHeaderDrawerBtn"
- tapOn:
    id: "menuItemButton-Feeds"
- tapOn:
    id: "editFeedsBtn"
- tapOn:
    label: "Tap on down arrow"
    id: "feed-timeline-moveDown"
- tapOn:
      label: "Save button"
      id: "saveChangesBtn"
- tapOn:
    id: "viewHeaderDrawerBtn"
- assertVisible:
    id: "homeScreenFeedTabs-selector-0"
    text: "alice-favs"
- assertVisible:
    id: "homeScreenFeedTabs-selector-1"
    text: "Following"

# Set following first
- tapOn:
    id: "viewHeaderDrawerBtn"
- tapOn:
    id: "menuItemButton-Feeds"
- tapOn:
    id: "editFeedsBtn"
- tapOn:
    label: "Tap on down arrow"
    id: "feed-feed-moveDown"
- tapOn:
    label: "Save button"
    id: "saveChangesBtn"
- tapOn:
    id: "viewHeaderDrawerBtn"
- assertVisible:
    id: "homeScreenFeedTabs-selector-0"
    text: "Following"
- assertVisible:
    id: "homeScreenFeedTabs-selector-1"
    text: "alice-favs"

# Remove following
- tapOn:
    id: "viewHeaderDrawerBtn"
- tapOn:
    id: "menuItemButton-Feeds"
- tapOn:
    id: "editFeedsBtn"
- tapOn:
    label: "Tap on unpin"
    id: "feed-timeline-togglePin"
- tapOn:
      label: "Save button"
      id: "saveChangesBtn"
- tapOn:
    id: "viewHeaderDrawerBtn"
- assertVisible:
    id: "homeScreenFeedTabs-selector-0"
    text: "alice-favs"
- assertNotVisible: "Following"
